---
phase: 08-legacy-cleanup
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/claude_teams/teams.py
  - tests/test_server.py
  - tests/test_mcp_multi_agent.py
  - tests/test_teams.py
  - tests/test_models.py
  - README.md
  - pyproject.toml
autonomous: true

must_haves:
  truths:
    - "No Claude model strings (claude-sonnet-4, claude-opus-4) appear in source or test code"
    - "README describes OpenCode + Kimi K2.5 setup, not Claude Code setup"
    - "pyproject.toml description references OpenCode, not Claude Code"
    - "README tools table lists all 15 tools including list_agent_templates, check_agent_health, check_all_agents_health"
    - "All tests pass after model string updates"
  artifacts:
    - path: "src/claude_teams/teams.py"
      provides: "Team module with Kimi K2.5 default model"
      contains: "moonshot-ai/kimi-k2.5"
    - path: "README.md"
      provides: "User-facing documentation for OpenCode setup"
      contains: "OpenCode"
    - path: "pyproject.toml"
      provides: "Package metadata with OpenCode description"
      contains: "OpenCode"
  key_links:
    - from: "tests/test_server.py"
      to: "src/claude_teams/models.py"
      via: "TeammateMember model field"
      pattern: "model=\"moonshot-ai/kimi-k2.5\""
---

<objective>
Update all Claude model strings to Kimi K2.5 and rewrite README/documentation to describe the current OpenCode system.

Purpose: CLEAN-04 (model string consistency) and CLEAN-05 (documentation accuracy). Users reading the README should understand this is an OpenCode + Kimi K2.5 system.
Output: Updated model strings in source/tests, rewritten README, updated pyproject.toml description.
</objective>

<execution_context>
@C:\Users\dasbl\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\dasbl\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-legacy-cleanup/08-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update Claude model strings to Kimi K2.5</name>
  <files>
    src/claude_teams/teams.py
    tests/test_server.py
    tests/test_mcp_multi_agent.py
    tests/test_teams.py
    tests/test_models.py
  </files>
  <action>
Replace every Claude model string with the equivalent Kimi K2.5 string. These are just arbitrary model identifiers passed through -- no functional change, just consistency.

In `src/claude_teams/teams.py` (line 43):
- Change `lead_model: str = "claude-opus-4-6"` to `lead_model: str = "moonshot-ai/kimi-k2.5"`

In `tests/test_server.py` (line 21):
- Change `model="claude-sonnet-4-20250514"` to `model="moonshot-ai/kimi-k2.5"`

In `tests/test_mcp_multi_agent.py` (line 30):
- Change `model="claude-sonnet-4-20250514"` to `model="moonshot-ai/kimi-k2.5"`

In `tests/test_teams.py` (line 26):
- Change `model="claude-sonnet-4-20250514"` to `model="moonshot-ai/kimi-k2.5"`

In `tests/test_models.py` (3 locations):
- Line 43: Change `model="claude-opus-4-6"` to `model="moonshot-ai/kimi-k2.5"`
- Line 60: Change `"model": "claude-opus-4-6"` to `"model": "moonshot-ai/kimi-k2.5"`
- Line 129: Change `model="claude-opus-4-6"` to `model="moonshot-ai/kimi-k2.5"`

Run `uv run pytest -x` after all changes to verify nothing broke.

IMPORTANT: Do NOT change anything with "claude" in: package name, MCP server name, storage paths, Python module paths, test fixture names, or tool prefixes. Only change model strings.
  </action>
  <verify>
Run: `uv run pytest -x -v`
All tests pass. Grep: `grep -r "claude-sonnet-4\|claude-opus-4" src/ tests/` returns zero results.
  </verify>
  <done>
No Claude model strings remain in source or test code. All tests pass. Only the package/server name "claude-teams" and storage path "~/.claude/" remain (intentionally).
  </done>
</task>

<task type="auto">
  <name>Task 2: Update pyproject.toml and README prose sections</name>
  <files>
    pyproject.toml
    README.md
  </files>
  <action>
Update `pyproject.toml` line 8:
- Change `description = "MCP server for orchestrating Claude Code agent teams"` to `description = "MCP server for orchestrating OpenCode agent teams with Kimi K2.5"`

Update the following README.md sections (leave other sections unchanged):

1. **Title and tagline** (lines 1-7): Keep the "claude-teams" name (it is the package name). Update the tagline from "Claude Code's agent teams protocol" to describe it as an MCP server for OpenCode agent teams.

2. **About section** (lines 15-21): Rewrite to explain that this MCP server implements a multi-agent coordination protocol originally inspired by Claude Code's agent teams feature, now targeting OpenCode + Kimi K2.5. Remove the reference to "Claude Code has a built-in agent teams feature" and the "deep dive" link -- keep the link but reframe as historical context.

3. **Requirements section** (lines 52-57): Change "Claude Code CLI on PATH" to "OpenCode CLI on PATH (v1.1.52+)". Add "or OpenCode Desktop app" as alternative.

4. **How it works / Spawning** (line 78): Change "Teammates launch as separate Claude Code processes in tmux panes" to "Teammates launch as separate OpenCode processes in tmux panes or as desktop app instances". Leave Messaging, Tasks, Concurrency safety unchanged.

IMPORTANT what NOT to change:
- Package name "claude-teams" everywhere
- The `.mcp.json` and `opencode.json` install snippets (lines 23-51)
- The `~/.claude/` storage paths
- The MIT license reference
- The Tools table (handled in Task 3)
  </action>
  <verify>
Read README.md and pyproject.toml. Verify:
- "Claude Code" does not appear as a description of what the system IS (historical context references are OK)
- "OpenCode" appears in system description and requirements
- "Kimi K2.5" mentioned in about section
- Requirements list OpenCode, not Claude Code
  </verify>
  <done>
README prose sections describe OpenCode + Kimi K2.5 system. pyproject.toml description updated. Requirements section lists OpenCode.
  </done>
</task>

<task type="auto">
  <name>Task 3: Update README tools table with new tools and accurate descriptions</name>
  <files>
    README.md
  </files>
  <action>
Replace the Tools table (lines 58-75) with an updated version. Changes:

1. Update `spawn_teammate` description from "Spawn a Claude Code teammate in a tmux pane" to "Spawn an OpenCode teammate in a tmux pane or desktop app instance."
2. Update `force_kill_teammate` description from "Forcibly kill a teammate's tmux pane and clean up" to "Forcibly kill a teammate's tmux pane or desktop process and clean up."
3. Add these three new tools (inserted after `force_kill_teammate`, before `process_shutdown_approved`):

| `list_agent_templates` | List available role templates from `.opencode/agents/` directory. |
| `check_agent_health` | Check the health status (alive, dead, hung) of a single agent. |
| `check_all_agents_health` | Check the health status of all agents in the current team. |

The final table should have 15 rows (12 existing + 3 new).
  </action>
  <verify>
Read README.md tools table. Verify:
- `spawn_teammate` says "OpenCode" not "Claude Code"
- `force_kill_teammate` mentions "desktop process"
- `list_agent_templates`, `check_agent_health`, `check_all_agents_health` are present with correct descriptions
- Table has 15 tool rows
  </verify>
  <done>
Tools table is complete and accurate with all 15 tools. New tools have specific, accurate descriptions. spawn_teammate and force_kill_teammate descriptions updated for OpenCode/desktop.
  </done>
</task>

</tasks>

<verification>
1. `uv run pytest -x -v` -- all tests pass
2. `grep -r "claude-sonnet-4\|claude-opus-4" src/ tests/` -- zero results
3. README does not describe the system as "Claude Code" (package name "claude-teams" is OK)
4. pyproject.toml description mentions OpenCode
5. Tools table includes all current tools (spawn_teammate, list_agent_templates, check_agent_health, check_all_agents_health, force_kill_teammate)
</verification>

<success_criteria>
- Zero Claude model strings in source or test code
- README describes OpenCode + Kimi K2.5 setup
- pyproject.toml description references OpenCode
- All tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/08-legacy-cleanup/08-02-SUMMARY.md`
</output>
